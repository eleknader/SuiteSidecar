<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SuiteSidecar</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500&family=Space+Grotesk:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./taskpane.css?v=0.2.0" />
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script defer src="./taskpane.js?v=0.2.0"></script>
  </head>
  <body>
    <div class="bg-shape bg-shape-a"></div>
    <div class="bg-shape bg-shape-b"></div>

    <main class="app-shell">
      <header class="hero">
        <p>Outlook / SuiteCRM -connector</p>
      </header>

      <section class="card">
        <h2>Connector</h2>
        <label for="connectorBaseUrl">Connector Base URL</label>
        <div class="row">
          <input id="connectorBaseUrl" type="url" placeholder="https://suitesidecar.example.com" />
          <button id="loadProfilesBtn" type="button">Load Profiles</button>
        </div>

        <label for="profileSelect">Profile</label>
        <select id="profileSelect"></select>
      </section>

      <section class="card">
        <h2>Login</h2>
        <label for="usernameInput">SuiteCRM Username</label>
        <input id="usernameInput" type="text" placeholder="admin" />

        <label for="passwordInput">SuiteCRM Password</label>
        <input id="passwordInput" type="password" placeholder="••••••••" />

        <div class="row">
          <button id="loginBtn" type="button">Login</button>
          <button id="logoutBtn" type="button">Logout</button>
        </div>

        <p id="sessionInfo" class="hint"></p>
      </section>

      <section class="card">
        <h2>Selected Email</h2>
        <p class="hint">Use current Outlook item when available; otherwise fill manually.</p>
        <p class="hint">When running inside Outlook, item changes auto-refresh this context and trigger lookup if logged in.</p>

        <div class="row">
          <button id="hydrateFromOutlookBtn" type="button">Use Selected Email</button>
        </div>

        <label for="senderEmailInput">Sender Email</label>
        <input id="senderEmailInput" type="email" placeholder="sender@example.com" />

        <label for="subjectInput">Subject</label>
        <input id="subjectInput" type="text" placeholder="Email subject" />

        <label for="internetMessageIdInput">Internet Message ID</label>
        <input id="internetMessageIdInput" type="text" placeholder="<message-id@example.com>" />

        <label for="recipientEmailsInput">Recipients (comma-separated)</label>
        <input id="recipientEmailsInput" type="text" placeholder="recipient@example.com" />
        <p id="attachmentsInfo" class="hint"></p>

        <label for="sentAtInput">Sent At (UTC)</label>
        <input id="sentAtInput" type="datetime-local" />
      </section>

      <section class="card">
        <h2>Lookup</h2>
        <div class="row">
          <button id="lookupBtn" type="button">Lookup by Sender Email</button>
        </div>

        <div id="lookupResult" class="result-box">
          <p class="hint">No lookup executed yet.</p>
        </div>
        <div id="timelineResult" class="result-box timeline-box">
          <p class="hint">No timeline loaded.</p>
        </div>
      </section>

      <section class="card">
        <h2>Actions</h2>
        <label for="firstNameInput">First Name</label>
        <input id="firstNameInput" type="text" placeholder="First name" />

        <label for="lastNameInput">Last Name</label>
        <input id="lastNameInput" type="text" placeholder="Last name" />

        <label for="titleInput">Title (optional)</label>
        <input id="titleInput" type="text" placeholder="Sales Manager" />

        <label for="companyInput">Company (Lead)</label>
        <input id="companyInput" type="text" placeholder="Example Oy" />

        <label for="linkModuleSelect">Log Link Module</label>
        <select id="linkModuleSelect">
          <option value="Contacts">Contacts</option>
          <option value="Leads">Leads</option>
          <option value="Accounts">Accounts</option>
          <option value="Opportunities">Opportunities</option>
          <option value="Cases">Cases</option>
        </select>

        <label for="linkIdInput">Log Link ID</label>
        <input id="linkIdInput" type="text" placeholder="CRM record id" />

        <label class="checkbox-row">
          <input id="storeBodyCheckbox" type="checkbox" checked />
          <span>Store body text in Note description</span>
        </label>

        <label class="checkbox-row">
          <input id="storeAttachmentsCheckbox" type="checkbox" />
          <span>Store attachments (subject to max size)</span>
        </label>

        <label for="maxAttachmentBytesInput">Max Attachment Bytes</label>
        <input id="maxAttachmentBytesInput" type="number" min="1" step="1" value="1048576" />

        <div class="row wrap">
          <button id="createContactBtn" type="button">Create Contact</button>
          <button id="createLeadBtn" type="button">Create Lead</button>
          <button id="logEmailBtn" type="button">Log Email</button>
        </div>
      </section>

      <section id="statusBox" class="status status-info">
        <strong>Status</strong>
        <p id="statusMessage">Ready.</p>
        <p id="statusRequestId" class="mono"></p>
      </section>
    </main>
  </body>
</html>
