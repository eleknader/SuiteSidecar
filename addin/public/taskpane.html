<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SuiteSidecar</title>
    <link rel="stylesheet" href="./taskpane.css?v=0.3.5" />
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script defer src="./taskpane.js?v=0.3.5"></script>
  </head>
  <body>
    <main class="app-shell">
      <section id="connectorCard" class="card">
        <h2>Connection</h2>
        <label for="connectorBaseUrl">Connector Base URL</label>
        <div class="row">
          <input id="connectorBaseUrl" type="url" placeholder="https://suitesidecar.example.com" />
          <button id="loadProfilesBtn" type="button">Load Profiles</button>
        </div>

        <label for="profileSelect">Profile</label>
        <select id="profileSelect"></select>
      </section>

      <section id="loginCard" class="card">
        <h2>Login</h2>
        <label for="usernameInput">SuiteCRM Username</label>
        <input id="usernameInput" type="text" placeholder="admin" />

        <label for="passwordInput">SuiteCRM Password</label>
        <input id="passwordInput" type="password" placeholder="••••••••" />

        <div class="row">
          <button id="loginBtn" type="button">Login</button>
          <button id="logoutBtn" type="button">Logout</button>
        </div>

        <p id="sessionInfo" class="hint"></p>
      </section>

      <section id="quickActionsBar" class="quick-actions is-hidden">
        <div class="row wrap">
          <button id="logEmailBtn" type="button">Log Email</button>
          <button id="createCallBtn" type="button" disabled>Create Call</button>
          <button id="createMeetingBtn" type="button" disabled>Create Meeting</button>
          <button id="createTaskBtn" type="button" disabled>Create Task</button>
        </div>
        <p id="taskActionResult" class="hint action-result"></p>
      </section>

      <section id="actionsCard" class="card is-collapsed">
        <div class="card-head">
          <h2>Details</h2>
          <button id="toggleActionsBtn" type="button" aria-controls="actionsCard" aria-expanded="false">Details</button>
        </div>
        <div id="actionsBody" class="card-body">
          <div class="row wrap">
            <button id="createContactBtn" class="is-hidden" type="button">Create Contact</button>
            <button id="createLeadBtn" class="is-hidden" type="button">Create Lead</button>
          </div>

          <label for="firstNameInput">First Name</label>
          <input id="firstNameInput" type="text" placeholder="First name" />

          <label for="lastNameInput">Last Name</label>
          <input id="lastNameInput" type="text" placeholder="Last name" />

          <label for="titleInput">Title (optional)</label>
          <input id="titleInput" type="text" placeholder="Sales Manager" />

          <label for="companyInput">Company (Lead)</label>
          <input id="companyInput" type="text" placeholder="Example Oy" />

          <label for="linkModuleSelect">Log Link Module</label>
          <select id="linkModuleSelect">
            <option value="Contacts">Contacts</option>
            <option value="Leads">Leads</option>
            <option value="Accounts">Accounts</option>
            <option value="Opportunities">Opportunities</option>
            <option value="Cases">Cases</option>
          </select>

          <label for="linkIdInput">Log Link ID</label>
          <input id="linkIdInput" type="text" placeholder="CRM record id" />

          <label class="checkbox-row">
            <input id="storeBodyCheckbox" type="checkbox" checked />
            <span>Store body text in Note description</span>
          </label>

          <label class="checkbox-row">
            <input id="storeAttachmentsCheckbox" type="checkbox" checked />
            <span>Store attachments (subject to max size)</span>
          </label>

          <label for="maxAttachmentBytesInput">Max Attachment Bytes</label>
          <input id="maxAttachmentBytesInput" type="number" min="1" step="1" value="5242880" />
        </div>
      </section>

      <section id="lookupCard" class="card">
        <h2>Lookup</h2>
        <div id="lookupResult" class="result-box">
          <p class="hint">No lookup executed yet.</p>
        </div>
        <div id="timelineResult" class="result-box timeline-box is-hidden">
          <p class="hint">No timeline loaded.</p>
        </div>
      </section>

      <section id="opportunitiesCard" class="card">
        <h2>Opportunities</h2>
        <div id="opportunitiesResult" class="result-box">
          <p class="hint">No opportunities loaded.</p>
        </div>
      </section>

      <section id="selectedEmailCard" class="card">
        <h2>Selected Email</h2>
        <label for="senderEmailInput">Sender Email</label>
        <input id="senderEmailInput" type="email" placeholder="sender@example.com" />

        <label for="subjectInput">Subject</label>
        <input id="subjectInput" type="text" placeholder="Email subject" />

        <label for="internetMessageIdInput">Internet Message ID</label>
        <input id="internetMessageIdInput" type="text" placeholder="<message-id@example.com>" />

        <label for="recipientEmailsInput">Recipients</label>
        <input id="recipientEmailsInput" type="text" placeholder="recipient@example.com" />
        <p id="attachmentsInfo" class="hint"></p>

        <label for="sentAtInput">Sent At (UTC)</label>
        <input id="sentAtInput" type="datetime-local" />
      </section>

      <section id="statusBox" class="status status-info">
        <p id="statusMessage">Ready.</p>
        <p id="statusRequestId" class="mono"></p>
        <div id="sessionActionsRow" class="row wrap session-actions is-hidden">
          <button id="statusLogoutBtn" type="button">Logout</button>
        </div>
      </section>
    </main>
  </body>
</html>
